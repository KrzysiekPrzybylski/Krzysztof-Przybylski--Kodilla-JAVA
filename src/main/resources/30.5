CREATE TABLE STATS(
                      STAT_ID INT(11) AUTO_INCREMENT PRIMARY KEY,
                      STAT_DATE DATETIME NOT NULL,
                      STAT VARCHAR(20) NOT NULL,
                      VALUE INT(11) NOT NULL
);

CREATE VIEW BESTSELLER_COUNT AS
SELECT COUNT(*) FROM BOOKS
WHERE BOOKS.BESTSELLER = true;

SELECT * FROM BESTSELLER_COUNT;

CREATE EVENT  UPDATEBESTSELLERSEVENT
    ON SCHEDULE EVERY 1 MINUTE
    DO
BEGIN
            DECLARE NUMBER_OF_BESTSELLERS INT DEFAULT 0;
SELECT * FROM BESTSELLER_COUNT
    INTO NUMBER_OF_BESTSELLERS;
INSERT INTO STATS (STAT_DATE, STAT, VALUE)
    VALUE(NOW(),'BESTSELLERS',NUMBER_OF_BESTSELLERS);
end;

SHOW PROCESSLIST ;

UPDATE STATS
SET VALUE = 0;

SELECT  * FROM STATS;